#分布式事务-本地消息表  
基于本地消息表+定时任务最终一致性方案来解决分布式事务问题  

## 项目说明  
基于本地消息表方案中，将本事务外的操作，记录在本地事务表中。本地事务外的其他事务，提供操作接口来完成事务  
本地系统定时任务轮询本地消息表，将未执行完成的消息调用外部事务接口，根据处理成功情况来更新本地消息表的状态  
定时任务并安照一定周期执行，针对屡次失败的消息，设计最大失败阈值，超过阈值不再处理而进行人工处理  

### 业务流程  
该项目是用两个数据源来模拟是两个系统的事务，可以理解为支付系统和订单系统  

1. 用户在订单系统购买商品并进行支付（即调用支付系统）  
2. 支付系统完成支付操作，写本地消息表使用定时任务轮询本地事务表并回调订单系统接口，以便通知订单系统支付成功  
3. 订单系统根据支付系统的回调接口修改订单状态    

## 本地消息表的优点  
+ 避免了分布式事务，最终一致性  

## 本地消息表的缺点  
+ 需要注意接口的幂等性处理，避免重复消费导致数据不一致  